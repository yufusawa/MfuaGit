### [Вернуться на Главную](/README.md)

## Поддержка и тестирование программных модулей

Лекция 3.

Рассмотрение автоматизации в рамках учебной дисциплины позволяет студентам не просто освоить инструменты, а понять их место в жизненном цикле ПО и выработать правильные привычки с самого начала.

Вот развернутый материал по автоматизации разработки технической документации, адаптированный для учебного контекста поддержки и тестирования программных модулей.

### Философия подхода для учебного процесса

**Главная цель:** Превратить документацию из "отчетности для преподавателя" в реальный инструмент, который *облегчает жизнь самим студентам* во время разработки, тестирования и отладки их же учебных проектов.

**Базовый принцип:** **Documentation-as-Code (DaC)** — документация это такой же код. Её пишут в текстовых форматах, хранят в Git, проверяют и собирают автоматически.

---

### Ключевые области автоматизации для учебных проектов

#### 1. Автоматизация документирования кода (API и модулей)

**Задача:** Сгенерировать описание того, *что делает* модуль (его публичные методы, классы, функции), прямо из комментариев в коде.

**Инструменты и подход:**

*   **Для Java:** **Javadoc**
    ```java
    /**
     * Вычисляет скидку на основе суммы покупки и статуса клиента.
     * Используется модулем {@link OrderProcessor}.
     *
     * @param orderSum общая сумма заказа
     * @param customerStatus статус клиента (например, "VIP", "REGULAR")
     * @return размер предоставляемой скидки
     * @throws IllegalArgumentException если orderSum отрицательный
     * @see Order
     */
    public double calculateDiscount(double orderSum, String customerStatus) {
        // ... код метода
    }
    ```
    *   **Связь с тестированием:** Понимание назначения метода и его граничных условий (`@throws`) помогает написать более полные модульные тесты (например, проверить передачу отрицательной `orderSum`).

*   **Для Python:** **Sphinx + autodoc**
    ```python
    def calculate_discount(order_sum: float, customer_status: str) -> float:
        """
        Вычисляет скидку на основе суммы покупки и статуса клиента.

        Args:
            order_sum: Общая сумма заказа. Должна быть неотрицательной.
            customer_status: Статус клиента ('VIP', 'REGULAR').

        Returns:
            Размер предоставляемой скидки в процентах.

        Raises:
            ValueError: Если `order_sum` отрицательное.

        Example:
            >>> calculate_discount(1000, "VIP")
            15.0
        """
        if order_sum < 0:
            raise ValueError("Сумма заказа не может быть отрицательной")
        # ... код метода
    ```
    *   **Связь с поддержкой:** Инженер (или одногруппник, разбирающий ваш код) видит четкий контракт функции, не вникая в её внутреннюю реализацию.

**Практическое задание для студентов:**
1.  Написать модуль из 3-4 функций.
2.  Задокументировать их с использованием docstring/javadoc.
3.  Настроить автоматическую сборку HTML-документации (например, с помощью `sphinx-build` или `mvn javadoc:javadoc`).
4.  Сгенерированную документацию разместить в папке `docs/` проекта.

#### 2. Автоматизация документирования архитектуры и API

**Задача:** Визуализировать структуру и взаимодействия модулей без ручного рисования диаграмм в графических редакторах.

**Инструменты и подход:**

*   **Диаграммы в виде кода:** **PlantUML**, Mermaid.js.
    *   Создание диаграмм последовательностей, состояний, компонентов в текстовом формате.
    *   **Пример (диаграмма последовательности для тест-кейса):**
        ```
        @startuml
        actor Тестировщик
        participant "Модуль А" as A
        participant "Модуль Б" as B

        Тестировщик -> A: вызов метода X()
        activate A
        A -> B: запрос данных
        activate B
        B --> A: возврат данных
        deactivate B
        A --> Тестировщик: результат
        deactivate A
        @enduml
        ```
    *   **Связь с тестированием:** Позволяет формализовать сценарии интеграционного тестирования. Такую диаграмму можно включить прямо в описание тест-кейса.

*   **Документирование REST API:** **OpenAPI (Swagger)**
    *   Описание API в YAML-файле.
    *   Автоматическая генерация интерактивной документации (Swagger UI) и клиентских SDK.

**Практическое задание для студентов:**
1.  Описать с помощью PlantUML процесс выполнения ключевого сценария своего модуля.
2.  Если модуль предоставляет REST API, описать его эндпоинты в формате OpenAPI 3.0.
3.  Настроить CI-пайплайн (например, в GitHub Actions), который при коммите в репозиторий автоматически генерирует и публикует сайт с этой документацией (на GitHub Pages).

#### 3. Автоматизация ведения основной документации (руководств, описаний)

**Задача:** Создать единый, легко обновляемый и доступный набор документов: руководство пользователя, описание установки, руководство тестировщика.

**Инструменты и подход:**

*   **Генераторы статических сайтов:** **MkDocs**, **Docusaurus**, Sphinx.
    *   Документация пишется в Markdown.
    *   Структура задается через файловую систему.
    *   **Ключевая папка для учебного проекта:**
        ```
        docs/
        ├── index.md          # Главная страница (описание проекта)
        ├── installation.md   # Руководство по установке
        ├── user-guide.md     # Руководство пользователя
        ├── testing.md        # Руководство тестировщика (описание тест-кейсов)
        └── developer-guide.md # Руководство разработчика (архитектура)
        ```
    *   **Связь с поддержкой:** В `testing.md` можно включить раздел "Известные проблемы", который сразу увидят все тестировщики и разработчики.

#### 4. Автоматизация связи "Код -> Тесты -> Документация"

**Задача:** Сделать так, чтобы документация всегда оставалась актуальной, а тесты были неотделимы от кода, который они проверяют.

**Инструменты и подход:**

*   **Хранение тестов рядом с кодом:**
    *   `src/main/java/com/example/MyModule.java`
    *   `src/test/java/com/example/MyModuleTest.java`
    *   Это автоматически связывает код и тесты для любого, кто открывает проект.

*   **Использование "Магического" комментария `// TODO:` и `// FIXME:`**
    *   Эти комментарии подсвечиваются в IDE и могут быть автоматически собраны в отчеты. `// FIXME: Этот метод падает при null-вводе. Нужно исправить к следующему спринту.` — это прямое указание на место для будущей работы по поддержке.

*   **CI/CD (Continuous Integration) — Сердце автоматизации:**
    *   **Простой пайплайн в GitHub Actions (файл `.github/workflows/ci.yml`):**
        ```yaml
        name: CI Pipeline
        on: [push]
        jobs:
          build-and-test:
            runs-on: ubuntu-latest
            steps:
              - uses: actions/checkout@v4
              - name: Set up Python
                uses: actions/setup-python@v4
              - name: Install dependencies
                run: pip install -r requirements.txt
              - name: Run Tests
                run: pytest --cov=my_module --cov-report=html  # Запуск тестов с отчетом о покрытии
              - name: Build Documentation
                run: mkdocs build  # Сборка документации
              - name: Deploy Docs
                if: github.ref == 'refs/heads/main'
                run: mkdocs gh-deploy --force  # Публикация документации на GitHub Pages
        ```
    *   **Что это дает студенту:**
        1.  **Автоматическая проверка тестов:** При каждом `git push` запускаются все тесты. Преподаватель и студент видят, не сломало ли новый код существующую функциональность.
        2.  **Автоматическая сборка документации:** Сайт с документацией всегда соответствует последней версии кода в ветке `main`.
        3.  **Отчет о покрытии кода тестами:** Студент наглядно видит, какие части его модуля не покрыты тестами.

---

### Пример сквозного учебного задания

**Тема:** "Разработка и тестирование модуля 'Калькулятор скидок'"

1.  **Разработка:**
    *   Создать класс `DiscountCalculator` с методом `calculate`.
    *   **Автоматически:** Задокументировать метод с помощью Javadoc/Sphinx, описав все параметры и исключения.

2.  **Тестирование:**
    *   Написать модульные тесты (JUnit/pytest) для всех сценариев.
    *   **Автоматически:** Создать диаграмму последовательности в PlantUML для сложного сценария расчета скидки и вставить её в `docs/testing.md`.

3.  **Интеграция:**
    *   Настроить CI-пайплайн, который:
        *   Запускает тесты при каждом коммите.
        *   Генерирует отчет о покрытии.
        *   Собирает и публикует документацию (как по коду, так и Markdown-руководства).

4.  **Поддержка:**
    *   Внести изменение в логику расчета скидки (имитация исправления бага).
    *   Убедиться, что пайплайн запустился, тесты прошли, а документация обновилась автоматически.

### Итог для учебной дисциплины

Автоматизация в контексте учебной дисциплины прививает **культуру инженерного труда**, где документация — это не "дополнительная нагрузка", а неотъемлемая и автоматизированная часть процесса. Студент, освоивший этот подход, выходит с следующими компетенциями:

*   Умеет создавать "живую" документацию, которая не устаревает.
*   Понимает жизненный цикл ПО от кода до тестов и пользовательских руководств.
*   Владеет базовыми навыками DevOps (работа с Git, CI/CD).
*   Видит прямую связь между качеством документации и эффективностью тестирования и поддержки.

Это превращает абстрактные требования дисциплины в конкретные, осязаемые и очень востребованные на практике навыки.